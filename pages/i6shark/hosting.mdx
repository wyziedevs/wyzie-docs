---
title: 'Hosting i6.shark'
---

# Hosting i6.shark

Setting up i6.shark requires a VPS with a /48 IPv6 subnet. Once configured, it runs autonomously with minimal maintenance.

## Steps

<Steps>
  <Steps.Step>
    Clone the repository to `/opt/i6.shark`:
    ```bash
    sudo git clone https://github.com/itzcozi/i6.shark.git /opt/i6.shark
    cd /opt/i6.shark
    ```
  </Steps.Step>
  <Steps.Step>
    Configure constants in `src/main.go`:
    ```bash
    sudo nano /opt/i6.shark/src/main.go
    ```
    Update `SharedSecret`, `IPv6Prefix`, and `Interface` to match your server:
    ```go
    const (
      SharedSecret          = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" // Secret between client & server
      Version               = "3.0"                              // Version of the script
      IPv6Prefix            = "xxxx:xxxx:xxxx"                   // Your /48 prefix
      IPv6Subnet            = "6000"                             // Using subnet 1000 within your /48
      Interface             = "ens3"                             // Detected interface from your system
      ListenPort            = 80                                 // Proxy server port
      ListenHost            = "0.0.0.0"                          // Listen on all interfaces
      RequestTimeout        = 30 * time.Second                   // Request timeout in seconds
      Debug                 = false                              // Enable debug output
      DesiredPoolSize       = 250                                // Target number of IPs in the pool
      PoolManageInterval    = 500 * time.Millisecond             // Check pool frequently
      PoolAddBatchSize      = 25                                 // Larger batches for faster pool growth
      IPFlushInterval       = 1 * time.Hour                      // Flush all IPs every hour
      MaxRequestsPerIP      = 100                                // Maximum requests allowed per IP before rotation
      UnusedIPFlushInterval = 10 * time.Minute                   // Check for unused IPs every 10 minutes
      IPInactivityThreshold = 30 * time.Minute                   // Remove IP if unused for this duration
      MaxConcurrentPerIP    = 15                                 // Maximum concurrent requests per IP
    )
    ```
  </Steps.Step>
  <Steps.Step>
    Build the application:
    ```bash
    cd /opt/i6.shark
    sudo go build -o i6shark ./src
    ```
  </Steps.Step>
  <Steps.Step>
    Create the systemd service:
    ```bash
    sudo tee /etc/systemd/system/i6shark.service >/dev/null <<'EOF'
    [Unit]
    Description=i6.shark IPv6 proxy
    After=network-online.target
    Wants=network-online.target

    [Service]
    WorkingDirectory=/opt/i6.shark
    ExecStart=/opt/i6.shark/i6shark
    Restart=always
    RestartSec=3
    User=root
    AmbientCapabilities=CAP_NET_BIND_SERVICE CAP_NET_ADMIN

    [Install]
    WantedBy=multi-user.target
    EOF
    ```
  </Steps.Step>
  <Steps.Step>
    Enable and start the service:
    ```bash
    sudo systemctl daemon-reload
    sudo systemctl enable --now i6shark
    ```
    Check the status:
    ```bash
    sudo systemctl status i6shark
    ```
  </Steps.Step>
</Steps>

The proxy server will now run automatically on boot and restart itself if it crashes.

## Daily Restart (Optional)

Add a cron job to restart the server daily at a random time:

```bash
(sudo crontab -l 2>/dev/null; echo "$(shuf -i 0-59 -n 1) $(shuf -i 0-23 -n 1) * * * systemctl restart i6shark") | sudo crontab -
```

## API Authentication

API tokens are generated using HMAC-SHA256 with a shared secret key. The input for key generation is the user-agent header. See the `validateAPIToken` function in the source code for implementation details.

<Note>
  A Python version is available but **not recommended** as it is slower and not up to date.
</Note>
